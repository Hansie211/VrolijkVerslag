(globalThis["webpackChunkvrolijkverslag"]=globalThis["webpackChunkvrolijkverslag"]||[]).push([[179],{3539:(e,t,n)=>{"use strict";n.d(t,{U:()=>o});const i=JSON.parse('{"title":"Vrolijk Verslag","maxImagesPerDay":20,"imageSize":{"width":1280,"height":1280}}'),a=i;function o(e,t){const n=a[e];return void 0===n?t:n}},5789:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(4253);class a{constructor(){}static getLastMonday(e=void 0){const t=null!==e&&void 0!==e?e:new Date,n=t.getDay(),i=t.getDate()-n+(0===n?-6:1),a=new Date(t.setDate(i));return a.toISOString().slice(0,10)}static getWeekDay(e){if(e<0||e>=this.DAYS.length)throw new Error(`Invalid index ${e}`);return this.DAYS[e]}static getWeekNumber(e){return(0,i.s)(e)}}a.DAYS=["Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"]},2179:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>le});var i=n(1758),a=n(8790),o=n(9104);const r={id:"page-title-header",style:{display:"flex","align-items":"center","flex-direction":"column",width:"100%"}},l={class:"text-h3 q-mb-md"},s={autocorrect:"on",autocapitalize:"on",autocomplete:"off",spellcheck:"true",style:{height:"100%"}},c={id:"image-row",class:"q-my-md",style:{height:"80px",display:"flex","flex-grow":"0","flex-shrink":"0"}};function d(e,t,n,d,u,m){const g=(0,i.g2)("q-input"),p=(0,i.g2)("q-popup-edit"),h=(0,i.g2)("q-tab"),f=(0,i.g2)("q-tabs"),x=(0,i.g2)("q-btn"),y=(0,i.g2)("q-space"),v=(0,i.g2)("q-tab-panel"),b=(0,i.g2)("q-tab-panels"),w=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(w,{padding:"",style:{display:"flex","align-items":"center","flex-direction":"column",width:"100%",position:"relative","padding-left":"50px","padding-right":"50px"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",r,[(0,i.Lk)("div",l,[(0,i.eW)(" Week "+(0,a.v_)(e.DateUtils.getWeekNumber(e.report.startDate))+" - "+(0,a.v_)(e.report.theme)+" ",1),(0,i.bF)(p,{modelValue:e.report.theme,"onUpdate:modelValue":t[0]||(t[0]=t=>e.report.theme=t),buttons:""},{default:(0,i.k6)((e=>[(0,i.bF)(g,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",counter:"",onKeyup:(0,o.jR)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:1},8,["modelValue"])]),(0,i.bF)(f,{modelValue:e.currentDay,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentDay=t),dense:"","active-color":"primary","indicator-color":"primary","narrow-indicator":""},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.values(e.report.dayReports),((t,n)=>((0,i.uX)(),(0,i.Wv)(h,{key:n,name:n,label:e.DateUtils.getWeekDay(n)},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])]),(0,i.bF)(b,{modelValue:e.currentDay,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentDay=t),animated:"",style:{width:"100%","min-width":"1000px",height:"100%",display:"flex","flex-direction":"column"}},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.values(e.report.dayReports),((t,n)=>((0,i.uX)(),(0,i.Wv)(v,{key:n,name:n,style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"}},{default:(0,i.k6)((()=>[(0,i.Lk)("form",s,[(0,i.bF)(g,{modelValue:t.description,"onUpdate:modelValue":e=>t.description=e,type:"textarea",debounce:"300",style:{height:"100%","font-size":"14pt","font-family":"Tahoma, sans-serif","line-height":"1.2"},"input-style":"height: 100%; resize: none",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),(0,i.Lk)("div",c,[(0,i.bF)(x,{size:"xl",icon:"photo_camera",label:"+",onClick:t=>e.openImageDialog(n)},null,8,["onClick"]),(0,i.bF)(y),(0,i.bF)(x,{icon:"email",onClick:e.doExport,size:"xl"},null,8,["onClick"])])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])),_:1})}var u=n(5182),m=n(8734),g=n(455),p=n(7958),h=n(3539);class f{constructor(){}static createTemplate(e,t){let i=n(1684)(`./${e}-template.html`).default;return Object.keys(t).forEach((e=>{const n=t[e],a=Array.isArray(n)?n.join(""):n.toString();i=i.replaceAll(`%${e.toUpperCase()}%`,a)})),i}}const x={class:"flex flex-center column q-px-sm",style:{width:"100%",height:"100%","flex-shrink":"1","flex-wrap":"nowrap"}},y={style:{width:"240px","flex-grow":"0","flex-shrink":"0"}},v={style:{width:"200px",height:"200px","flex-grow":"0","flex-shrink":"0",display:"inline-block",position:"relative"},class:"q-pa-sm"},b=["src"];function w(e,t,n,a,o,r){const l=(0,i.g2)("q-img"),s=(0,i.g2)("q-input"),c=(0,i.g2)("q-btn"),d=(0,i.g2)("q-item"),u=(0,i.g2)("q-list"),m=(0,i.g2)("q-scroll-area"),g=(0,i.g2)("q-card-section"),p=(0,i.g2)("q-space"),h=(0,i.g2)("q-card-actions"),f=(0,i.g2)("q-card"),w=(0,i.g2)("q-dialog");return(0,i.uX)(),(0,i.Wv)(w,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,i.k6)((()=>[(0,i.bF)(f,{class:"q-dialog-plugin",style:{width:"900px",height:"800px",display:"flex","flex-direction":"column","max-height":"100%"}},{default:(0,i.k6)((()=>[(0,i.bF)(g,{class:"row",style:{height:"100%","flex-wrap":"nowrap","max-height":"100%","min-height":"0"}},{default:(0,i.k6)((()=>{var n;return[(0,i.Lk)("div",x,[(0,i.bF)(l,{src:null===(n=e.currentImage)||void 0===n?void 0:n.image,style:{"max-width":"100%",height:"100%","margin-bottom":"10px"},fit:"contain"},null,8,["src"]),(0,i.bF)(s,{ref:"imageTextInput",modelValue:e.currentImageText,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentImageText=t),type:"textarea",debounce:"300",style:{height:"100px",width:"100%","flex-grow":"0","flex-shrink":"0","font-size":"14pt","font-family":"Tahoma, sans-serif","line-height":"1.2"},"input-style":"height: 100%; resize: none",outlined:"",autofocus:"",disable:void 0===e.currentImage},null,8,["modelValue","disable"])]),(0,i.Lk)("div",y,[(0,i.bF)(m,{style:{height:"100%"}},{default:(0,i.k6)((()=>[(0,i.bF)(u,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.dayReport.images,((t,n)=>((0,i.uX)(),(0,i.Wv)(d,{key:t,clickable:"",onClick:t=>e.setCurrentImage(n),active:n===e.currentImageIndex},{default:(0,i.k6)((()=>[(0,i.Lk)("div",v,[(0,i.bF)(c,{icon:"delete",size:"sm",style:{position:"absolute",top:"3px",right:"3px"},color:"white","text-color":"black",round:"",onClick:t=>e.removeImage(n)},null,8,["onClick"]),(0,i.Lk)("img",{src:t.image,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,b)])])),_:2},1032,["onClick","active"])))),128))])),_:1})])),_:1})])]})),_:1}),(0,i.bF)(h,{class:"q-px-md",style:{height:"100px","flex-grow":"0","flex-shrink":"0",display:"flex","flex-direction":"row","align-items":"center"}},{default:(0,i.k6)((()=>[(0,i.bF)(c,{icon:"add",size:"md",padding:"md",label:"toevoegen",color:"primary",onClick:t[1]||(t[1]=t=>e.uploadImage())}),(0,i.Lk)("input",{type:"file",ref:"fileInput",multiple:"",onChange:t[2]||(t[2]=t=>e.handleFileUpload(t)),style:{display:"none"},accept:"image/*"},null,544),(0,i.bF)(p),(0,i.bF)(c,{"icon-right":"close",size:"md",padding:"md",label:"Sluiten",onClick:e.onOKClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}var k=n(9782),I=function(e,t,n,i){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function l(e){try{s(i["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):a(e.value).then(r,l)}s((i=i.apply(e,t||[])).next())}))};class D{constructor(){}static getDataURI(e){return I(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=n,i.readAsDataURL(e)}))}))}}var A=function(e,t,n,i){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function l(e){try{s(i["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):a(e.value).then(r,l)}s((i=i.apply(e,t||[])).next())}))};class _{constructor(){}static loadImage(e){return new Promise(((t,n)=>{const i=new Image;i.src=URL.createObjectURL(e),i.onload=()=>{t(i)},i.onerror=n,i.src=URL.createObjectURL(e)}))}static getBlob(e,t){return new Promise(((n,i)=>{e.toBlob((e=>{null===e?i("Blob is null"):n(e)}),t)}))}static getNewSize(e,t,n){const i=e.width,a=e.height;if(i<=t&&a<=n)return{width:i,height:a};let o,r;return i>a?(r=a*(t/i),o=t):(o=i*(n/a),r=n),{width:o,height:r}}static resizeImage(e,t,n){return A(this,void 0,void 0,(function*(){const i=yield this.loadImage(e),a=this.getNewSize(i,t,n),o=document.createElement("canvas");o.width=t,o.height=n;const r=o.getContext("2d");if(null===r)throw new Error("Cannot create context");const l=(t-a.width)/2,s=(n-a.height)/2;return r.drawImage(i,l,s,a.width,a.height),yield this.getBlob(o,"image/png")}))}}var C=function(e,t,n,i){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function l(e){try{s(i["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):a(e.value).then(r,l)}s((i=i.apply(e,t||[])).next())}))};const R=(0,i.pM)({props:{dayIndex:{type:Number,required:!0},report:{}},emits:[...k.A.emits],setup(e){const t=e.report.dayReports[e.dayIndex],n=(0,m.KR)(0),{dialogRef:i,onDialogHide:a,onDialogOK:o,onDialogCancel:r}=(0,k.A)();return{dialogRef:i,onDialogHide:a,onOKClick(){o({num:1,v:"HALLO"})},onCancelClick:r,currentImageIndex:n,dayReport:t,emptyText:(0,m.KR)("")}},methods:{setCurrentImage(e){this.currentImageIndex=e,this.$refs["imageTextInput"].focus()},uploadImage(){this.dayReport.images.length>=this.maxImagesPerDay?this.$q.dialog({title:"Limiet bereikt",message:`Het maximaal aantal afbeeldingen (${this.maxImagesPerDay}) is voor deze dag bereikt.`}):this.$refs["fileInput"].click()},removeImage(e){this.dayReport.images.splice(e,1),e===this.currentImageIndex&&(this.currentImageIndex=0)},handleFileUpload(e){return C(this,void 0,void 0,(function*(){const t=e.target.files;if(e.target.type="text",e.target.type="file",t)for(let e=0;e<t.length&&this.dayReport.images.length<this.maxImagesPerDay;e++)try{const n=yield _.resizeImage(t[e],this.maxImageWidth,this.maxImageHeight);null===n&&console.warn("Cannot resize image");const i=yield D.getDataURI(n);this.dayReport.images.push({image:i,text:""})}catch(n){console.warn("Cannot process",t[e],n)}}))}},computed:{currentImage(){return this.dayReport.images[this.currentImageIndex]},maxImagesPerDay(){return(0,h.U)("maxImagesPerDay",10)},maxImageWidth(){return(0,h.U)("maxImageWidth",1280)},maxImageHeight(){return(0,h.U)("maxImageHeight",1280)},currentImageText:{get(){var e;return(null===(e=this.currentImage)||void 0===e?void 0:e.text)||""},set(e){this.currentImage&&(this.currentImage.text=e)}}}});var T=n(2807),q=n(558),E=n(3316),U=n(4189),F=n(2665),V=n(1194),P=n(2507),W=n(3999),L=n(124),Q=n(1693),z=n(2669),O=n(3676),j=n(8582),S=n.n(j);const M=(0,T.A)(R,[["render",w]]),K=M;S()(R,"components",{QDialog:q.A,QCard:E.A,QCardSection:U.A,QImg:F.A,QInput:V.A,QScrollArea:P.A,QList:W.A,QItem:L.A,QBtn:Q.A,QCardActions:z.A,QSpace:O.A});var N=n(5249),Y=function(e,t,n,i){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function l(e){try{s(i["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):a(e.value).then(r,l)}s((i=i.apply(e,t||[])).next())}))};class X{constructor(){}static showDialog(e){return Y(this,void 0,void 0,(function*(){return new Promise((t=>{N.A.create(e).onOk((e=>{t({state:"OK",payload:e})})).onCancel((()=>{t({state:"CANCEL",payload:void 0})}))}))}))}}var H=n(5789),$=function(e,t,n,i){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function l(e){try{s(i["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):a(e.value).then(r,l)}s((i=i.apply(e,t||[])).next())}))};function B(e){return e.trim().replace(/\n\s*\n/g,"\n").split("\n")}function G(e){const t={theme:e.theme,weekNumber:H.A.getWeekNumber(e.startDate)};for(let n=0;n<5;n++)t["text_day_"+n]=B(e.dayReports[n].description).map((e=>`<p>${e}</p>`)),t["img_day_"+n]=e.dayReports[n].images.map((e=>`\n    <div class="img-wrapper">\n    <img src="${e.image}" />\n    <div>${e.text}</div>\n    </div>\n    `));return t}const Z=(0,i.pM)({name:"VerslagPage",setup(){const e=(0,g.lq)(),t=(0,u.P)(),n=e.query["reportId"],i=t.get(n);if(void 0===i)throw new Error("Report is not found");return{weekReportStore:t,report:i,currentDay:(0,m.KR)(0),DateUtils:H.A}},computed:{maxImagesPerDay(){return(0,h.U)("maxImagesPerDay",10)}},methods:{openImageDialog(e){return $(this,void 0,void 0,(function*(){yield X.showDialog({component:K,componentProps:{report:this.report,dayIndex:e}})}))},doExport(){return $(this,void 0,void 0,(function*(){const e=G(this.report),t=f.createTemplate("report",e),n=new Blob([t],{type:"text/html"});(0,p.saveAs)(n,`Verslag week ${H.A.getWeekNumber(this.report.startDate)}.verslagtemplate`)}))}}});var J=n(7716),ee=n(604),te=n(6406),ne=n(327),ie=n(9041),ae=n(1746),oe=n(7156);const re=(0,T.A)(Z,[["render",d]]),le=re;S()(Z,"components",{QPage:J.A,QPopupEdit:ee.A,QInput:V.A,QTabs:te.A,QTab:ne.A,QTabPanels:ie.A,QTabPanel:ae.A,QBtn:Q.A,QSpace:O.A,QField:oe.A})},1421:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i='<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n\n      body {\n        font-family: Tahoma, sans-serif;\n        font-size: 18pt;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      }\n\n      .day-title:not(:nth-of-type(1)) {\n        page-break-before: always;\n        margin-top: 20cm;\n      }\n\n      .text-box {\n        margin-bottom: 80px;\n      }\n\n      img {\n        height: 12cm;\n        object-fit: contain;\n        margin-bottom: 3px;\n      }\n\n      p,\n      img,\n      .img-wrapper {\n        page-break-inside: avoid;\n        break-inside: avoid;\n      }\n\n      .img-box {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        width: 80%;\n      }\n\n      .img-wrapper {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        margin-top: 2mm;\n        margin-bottom: 2mm;\n      }\n\n      .img-wrapper > div {\n        font-size: 14pt;\n        text-align: center;\n      }\n\n\n    </style>\n    <title>Week %WEEKNUMBER% - %THEME%</title>\n  </head>\n  <body>\n      <h2>Week %WEEKNUMBER% - %THEME%</h2>\n\n      <div style="height: 10px"></div>\n\n      <h3 class="day-title">Maandag</h3>\n      <div class="text-box">%TEXT_DAY_0%</div>\n      <div class="img-box">%IMG_DAY_0%</div>\n\n      <h3 class="day-title">Dinsdag</h3>\n      <div class="text-box">%TEXT_DAY_1%</div>\n      <div class="img-box">%IMG_DAY_1%</div>\n\n      <h3 class="day-title">Woensdag</h3>\n      <div class="text-box">%TEXT_DAY_2%</div>\n      <div class="img-box">%IMG_DAY_2%</div>\n\n      <h3 class="day-title">Donderdag</h3>\n      <div class="text-box">%TEXT_DAY_3%</div>\n      <div class="img-box">%IMG_DAY_3%</div>\n\n      <h3 class="day-title">Vrijdag</h3>\n      <div class="text-box">%TEXT_DAY_4%</div>\n      <div class="img-box">%IMG_DAY_4%</div>\n    </div>\n  </body>\n</html>\n'},1684:(e,t,n)=>{var i={"./report-template.html":1421};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=o,e.exports=a,a.id=1684}}]);