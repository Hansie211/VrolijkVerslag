(globalThis["webpackChunkvrolijkverslag"]=globalThis["webpackChunkvrolijkverslag"]||[]).push([[755],{3539:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});const o=JSON.parse('{"title":"Vrolijk Verslag","maxImagesPerDay":20}'),i=o;function a(e,t){const n=i[e];return void 0===n?t:n}},3755:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y});var o=n(1758),i=n(8790),a=n(9104);const l={id:"page-title-header",style:{display:"flex","align-items":"center","flex-direction":"column",width:"100%",position:"relative"}},r={class:"text-h3 q-mb-md"},s={autocorrect:"on",autocapitalize:"on",autocomplete:"off",spellcheck:"true",style:{height:"100%"}},c={class:"q-my-md q-px-none q-gutter-x-sm",style:{height:"220px",display:"flex","flex-wrap":"nowrap","white-space":"nowrap","overflow-x":"auto","align-items":"center",gap:"5px","flex-grow":"0","flex-shrink":"0"}},d={style:{width:"200px",height:"200px",border:"1px solid lightgray",display:"flex","flex-grow":"0","flex-shrink":"0","justify-content":"center","align-items":"center"}},u=["onChange","id"],p=["src"];function g(e,t,n,g,h,m){const f=(0,o.g2)("q-input"),y=(0,o.g2)("q-popup-edit"),x=(0,o.g2)("q-tab"),v=(0,o.g2)("q-tabs"),b=(0,o.g2)("q-btn"),w=(0,o.g2)("q-tab-panel"),k=(0,o.g2)("q-tab-panels"),D=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(D,{padding:"",style:{display:"flex","align-items":"center","flex-direction":"column",width:"100%",position:"relative","padding-left":"50px","padding-right":"50px"}},{default:(0,o.k6)((()=>[(0,o.Lk)("div",l,[(0,o.Lk)("div",r,[(0,o.eW)(" Week "+(0,i.v_)(e.getISOWeek(e.report.startDate))+" - "+(0,i.v_)(e.report.theme)+" ",1),(0,o.bF)(y,{modelValue:e.report.theme,"onUpdate:modelValue":t[0]||(t[0]=t=>e.report.theme=t),buttons:""},{default:(0,o.k6)((e=>[(0,o.bF)(f,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",counter:"",onKeyup:(0,a.jR)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])),_:1},8,["modelValue"])]),(0,o.bF)(v,{modelValue:e.currentDay,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentDay=t),dense:"","active-color":"primary","indicator-color":"primary","narrow-indicator":""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.values(e.report.dayReports),((t,n)=>((0,o.uX)(),(0,o.Wv)(x,{key:n,name:n,label:e.getWeekDay(n)},null,8,["name","label"])))),128))])),_:1},8,["modelValue"]),(0,o.bF)(b,{icon:"print",onClick:e.doExport,style:{position:"absolute",right:"10px"},size:"xl"},null,8,["onClick"])]),(0,o.bF)(k,{modelValue:e.currentDay,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentDay=t),animated:"",style:{width:"100%","min-width":"1000px",height:"100%",display:"flex","flex-direction":"column"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.values(e.report.dayReports),((t,n)=>((0,o.uX)(),(0,o.Wv)(w,{key:n,name:n,style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"}},{default:(0,o.k6)((()=>[(0,o.Lk)("form",s,[(0,o.bF)(f,{modelValue:t.description,"onUpdate:modelValue":e=>t.description=e,type:"textarea",debounce:"300",style:{height:"100%","font-size":"14pt","font-family":"Tahoma, sans-serif","line-height":"1.2"},"input-style":"height: 100%",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("input",{type:"file",multiple:"",onChange:t=>e.handleFileUpload(n,t),style:{display:"none"},id:`fileInput${n}`,accept:"image/*"},null,40,u),(0,o.bF)(b,{size:"xl",icon:"photo_camera",onClick:t=>e.openFileInput(n),disable:t.images.length>=10},null,8,["onClick","disable"])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.images,((n,i)=>((0,o.uX)(),(0,o.CE)("div",{key:n,style:{width:"200px",height:"200px","flex-grow":"0","flex-shrink":"0",border:"1px solid lightgray",display:"inline-block",position:"relative","box-sizing":"border-box"},class:"q-pa-sm"},[(0,o.bF)(b,{icon:"delete",size:"sm",style:{position:"absolute",top:"3px",right:"3px"},flat:"",round:"",onClick:n=>e.removeImage(t,i)},null,8,["onClick"]),(0,o.Lk)("img",{src:n,style:{width:"100%",height:"100%","object-fit":"contain"}},null,8,p)])))),128))])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])),_:1})}var h=n(5182),m=n(8734),f=n(455),y=n(4253),x=n(7958),v=n(3539),b=function(e,t,n,o){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(o.next(e))}catch(t){a(t)}}function r(e){try{s(o["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))};class w{constructor(){}static loadImage(e){return new Promise(((t,n)=>{const o=new Image;o.src=URL.createObjectURL(e),o.onload=()=>{t(o)},o.onerror=n,o.src=URL.createObjectURL(e)}))}static getBlob(e,t){return new Promise(((n,o)=>{e.toBlob((e=>{null===e?o("Blob is null"):n(e)}),t)}))}static getNewSize(e,t,n){const o=e.width,i=e.height;if(o<=t&&i<=n)return{width:o,height:i};let a,l;return o>i?(l=i*(t/o),a=t):(a=o*(n/i),l=n),{width:a,height:l}}static resizeImage(e,t,n){return b(this,void 0,void 0,(function*(){const o=yield this.loadImage(e),i=this.getNewSize(o,t,n),a=document.createElement("canvas");a.width=t,a.height=n;const l=a.getContext("2d");if(null===l)throw new Error("Cannot create context");const r=(t-i.width)/2,s=(n-i.height)/2;return console.log("oW:",o.width,", oH:",o.height),console.log("nW:",i.width,", nH:",i.height),console.log("mW:",t,", mH:",n),console.log("x:",r,", y:",s),l.drawImage(o,r,s,i.width,i.height),yield this.getBlob(a,"image/png")}))}}var k=function(e,t,n,o){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(o.next(e))}catch(t){a(t)}}function r(e){try{s(o["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))};class D{constructor(){}static getDataURI(e){return k(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=n,o.readAsDataURL(e)}))}))}}class _{constructor(){}static createTemplate(e,t){let o=n(1684)(`./${e}-template.html`).default;return Object.keys(t).forEach((e=>{const n=t[e];o=o.replaceAll(`%${e.toUpperCase()}%`,Array.isArray(n)?n.join(""):n.toString())})),o}}var I=function(e,t,n,o){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(o.next(e))}catch(t){a(t)}}function r(e){try{s(o["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(l,r)}s((o=o.apply(e,t||[])).next())}))};function E(e){return e.trim().replace(/\n\s*\n/g,"\n").split("\n")}function A(e){const t={theme:e.theme,weekNumber:(0,y.s)(e.startDate)};for(let n=0;n<5;n++)t["text_day_"+n]=E(e.dayReports[n].description).map((e=>`<p>${e}</p>`)),t["img_day_"+n]=e.dayReports[n].images.map((e=>`<img src="${e}" />`));return t}const T=(0,o.pM)({name:"VerslagPage",setup(){const e=(0,f.lq)(),t=(0,h.P)(),n=e.query["reportId"],o=t.get(n);if(void 0===o)throw new Error("Report is not found");return{weekReportStore:t,report:o,currentDay:(0,m.KR)(0),getISOWeek:y.s}},computed:{maxImagesPerDay(){return(0,v.U)("maxImagesPerDay",10)}},methods:{getWeekDay(e){const t=["Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"];return t[e]},openFileInput(e){const t=document.querySelector(`#fileInput${e}`);t&&t.click()},removeImage(e,t){e.images.splice(t,1)},doExport(){return I(this,void 0,void 0,(function*(){const e=A(this.report),t=_.createTemplate("report",e),n=new Blob([t],{type:"text/plain"});(0,x.saveAs)(n,`Verslag week ${(0,y.s)(this.report.startDate)}.verslagtemplate`)}))},handleFileUpload(e,t){return I(this,void 0,void 0,(function*(){const n=t.target.files;if(t.target.type="text",t.target.type="file",!n)return;const o=this.report.dayReports[e];for(let e=0;e<n.length&&o.images.length<this.maxImagesPerDay;e++)try{const t=yield w.resizeImage(n[e],1280,720);null===t&&console.warn("Cannot resize image");const i=yield D.getDataURI(t);o.images.push(i)}catch(i){console.warn("Cannot process",n[e],i)}}))}}});var C=n(2807),U=n(3177),V=n(4308),R=n(7868),F=n(1691),W=n(6721),j=n(6959),P=n(4082),q=n(3815),L=n(9923),M=n(8264),O=n(1225),z=n(8582),X=n.n(z);const Q=(0,C.A)(T,[["render",g]]),Y=Q;X()(T,"components",{QPage:U.A,QPopupEdit:V.A,QInput:R.A,QTabs:F.A,QTab:W.A,QBtn:j.A,QTabPanels:P.A,QTabPanel:q.A,QCarousel:L.A,QCarouselSlide:M.A,QField:O.A})},1421:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n      body {\n        font-family: Tahoma, sans-serif;\n        font-size: 18pt;\n      }\n\n      .day-title:not(:nth-of-type(1)) {\n        page-break-before: always;\n        margin-top: 20cm;\n      }\n\n      .text-box {\n        margin-bottom: 80px;\n      }\n\n      img {\n        height: 13cm;\n        margin-top: 2mm;\n        margin-bottom: 2mm;\n        object-fit: contain;\n      }\n\n      p,\n      img {\n        page-break-inside: avoid;\n        break-inside: avoid;\n      }\n\n      .img-box {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n      }\n\n      body {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      }\n\n    </style>\n    <title>Week %WEEKNUMBER% - %THEME%</title>\n  </head>\n  <body>\n      <h2>Week %WEEKNUMBER% - %THEME%</h2>\n\n      <div style="height: 10px"></div>\n\n      <h3 class="day-title">Maandag</h3>\n      <div class="text-box">%TEXT_DAY_0%</div>\n      <div class="img-box">%IMG_DAY_0%</div>\n\n      <h3 class="day-title">Dinsdag</h3>\n      <div class="text-box">%TEXT_DAY_1%</div>\n      <div class="img-box">%IMG_DAY_1%</div>\n\n      <h3 class="day-title">Woensdag</h3>\n      <div class="text-box">%TEXT_DAY_2%</div>\n      <div class="img-box">%IMG_DAY_2%</div>\n\n      <h3 class="day-title">Donderdag</h3>\n      <div class="text-box">%TEXT_DAY_3%</div>\n      <div class="img-box">%IMG_DAY_3%</div>\n\n      <h3 class="day-title">Vrijdag</h3>\n      <div class="text-box">%TEXT_DAY_4%</div>\n      <div class="img-box">%IMG_DAY_4%</div>\n    </div>\n  </body>\n</html>\n'},1684:(e,t,n)=>{var o={"./report-template.html":1421};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=a,e.exports=i,i.id=1684}}]);